name: 'Test node-setup Action'

on:
  push:
    paths:
      - '.github/workflows/test-node-setup.yaml'
      - '/node-setup/**'
      - '/*'

permissions:
  actions: 'write'

jobs:
  setup-node:
    runs-on: 'ubuntu-latest'
    steps:
      - name: 'Checkout Repository ğŸ›ï¸'
        uses: 'actions/checkout@v3'

      - name: 'Setup node ğŸ›ï¸'
        uses: './node-setup'
        with:
          node-version-file: ''

      - name: 'Ensure node_modules exists âœ…'
        run: |-
          dir="$(pwd)/node_modules"
          if [ -d "$dir" ]; then
            echo "âœ… $dir exists."
          else
            echo "âŒ $dir does not exist."
            dir_up=$(dirname $dir)
            echo "Contents of $dir_up:"
            ls -lha "$dir_up"
            exit 1
          fi
